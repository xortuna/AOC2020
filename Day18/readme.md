I fully admit the 2nd part was a complete hackjob. It works by inserting brackets around addition functions to force the precedence.

It would be interesting I think to make the actual logic work with precedence but I suspect this is quite the task.
